<!-- OOB update for the snapshot count in the header -->
<span id="snap-count-badge" hx-swap-oob="innerHTML">{{ snap_count or 0 }}</span>

{% if global_snapshots %}
<table class="inventory-list-table">
    <thead>
        <tr>
            <th style="width: 20%">VM Name</th>
            <th style="width: 15%">vCenter</th>
            <th style="width: 15%">Snapshot Name</th>
            <th style="width: 10%">Age</th>
            <th style="width: 20%">Created At</th>
            <th style="width: 20%">Description</th>
        </tr>
    </thead>
    <tbody>
        {% for snap in global_snapshots %}
        <tr class="vm-row vc-color-{{ snap.vc_color_index }}" data-vm-id="{{ snap.vm_id }}"
            data-vcenter-id="{{ snap.vcenter_id }}"
            hx-get="/api/inventory/vm-details/{{ snap.vcenter_id }}/{{ snap.vm_id }}" hx-target="#vm-details-panel"
            hx-trigger="click" onclick="syncVmSelection('{{ snap.vcenter_id }}', '{{ snap.vm_id }}')">
            <td style="font-weight: 600; color: var(--text-main);">{{ snap.vm_name }}</td>
            <td style="font-size: 0.75rem; color: var(--text-dim);">{{ snap.vcenter_name }}</td>
            <td style="color: var(--primary); font-weight: 500;">{{ snap.name }}</td>
            <td>
                {% if snap.age_days < 2 %} <span class="age-pill age-new">{{ snap.age_days }}d</span>
                    {% elif snap.age_days <= 3 %} <span class="age-pill age-mid">{{ snap.age_days }}d</span>
                        {% else %}
                        <span class="age-pill age-old">{{ snap.age_days }}d</span>
                        {% endif %}
            </td>
            <td style="font-size: 0.8rem; color: var(--text-dim);">{{ snap.created.replace('T', ' ').split('.')[0] }}
            </td>
            <td style="font-size: 0.75rem; color: var(--text-dim);" title="{{ snap.description }}">{{ snap.description
                or '--' }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div style="padding: 4rem; text-align: center; color: var(--text-dim);">
    <i data-lucide="camera-off" size="48" style="margin-bottom: 1rem; opacity: 0.2;"></i>
    <p>No snapshots found across all connected environments.</p>
</div>
{% endif %}